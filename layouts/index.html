{{ define "main" }}
<main id="main-content" class="home" tabindex="-1">

  <!-- >>> START HERO SECTION -->
  <div class="hero-layout">
    <section
      class="hero has-hero-bg"
      data-bg="{{ ("images/bg_image.webp" | absURL) }}?v={{ with site.Params.appVer }}{{ . }}{{ end }}"
      aria-label="Hero EventHorizon.mtg"
    >
      <div class="hero__inner">
        <div class="hero__content">
          <!-- >>> START HERO LOGO -->
          <img class="hero__logo"
                src="{{ ("images/logo.webp" | absURL) }}?v={{ with site.Params.appVer }}{{ . }}{{ end }}"
                alt="Logo {{ .Site.Title }}"
                width="140" height="140"
                decoding="async"
                fetchpriority="high" />
          <!-- <<< END HERO LOGO -->

          <!-- Text hero -->
          <h1 class="hero__title">BEYOND THE HORIZON</h1>
          <p class="hero__subtitle">
            Narrativa e mazzi Commander.
            <br>Tutto su un'unica rotta!
          </p>
          <div class="hero__actions">
            <a class="btn btn--special" href="{{ "/archive/" | absURL }}">Esplora l'Archivio</a>
            <a class="btn btn--mox-glass" href="https://moxfield.com/users/EventHorizonMtG" target="_blank" rel="noopener">Le nostre Decklist</a>
          </div>
        </div>
      </div>

    </section>
  </div>
  <!-- <<< END HERO -->

  <!-- >>> START CARDS SECTION -->
  <section id="cards" class="cards cards--slider cards--panels" aria-labelledby="cards-title">
    <div class="cards__inner">
      <div class="cards__header">
        <h2 id="cards-title" class="cards__title">Ultimi Contenuti</h2>
        <a href="{{ "/archive/" | absURL }}" class="cards__view-all" aria-label="Vedi tutti i contenuti">
          Vedi Tutto →
        </a>
      </div>

      <div id="cards-carousel" class="cards__viewport js-cards-carousel" aria-roledescription="carousel" aria-label="Carousel ultimi contenuti">
      <div class="cards__grid cards__track" role="list">
        {{/* Ultime 4 dal data archive: solo directory data/archive/items/*.yml */}}
        {{ $items := slice }}
        {{ with .Site.Data.archive.items }}
          {{ range $k, $v := . }}
            {{ if not $v.draft }}{{ $items = $items | append $v }}{{ end }}
          {{ end }}
        {{ end }}
        {{ $items = sort $items "date" "desc" }}
        {{ $items = first (cond (gt (len $items) 4) 4 (len $items)) $items }}

        {{ if gt (len $items) 0 }}
          {{ range $i, $it := $items }}
            {{ $isVideo := eq (lower $it.kind) "video" }}
            {{ $thumbURL := ("images/cards/fblthp_placeholder.webp" | absURL) }}
            {{ with $it.card }}
              {{ $c := . }}
              {{ if hasPrefix $c "http" }}
                {{ $thumbURL = $c }}
              {{ else }}
                {{ $thumbURL = ($c | absURL) }}
              {{ end }}
            {{ else }}
              {{ with $it.thumb }}
                {{ $t := . }}
                {{ if hasPrefix $t "http" }}
                  {{ $thumbURL = $t }}
                {{ else }}
                  {{ $thumbURL = ($t | absURL) }}
                {{ end }}
              {{ end }}
            {{ end }}
            {{ $over  := $it.overline }}
            {{ $tit   := $it.title }}
            {{ $desc  := $it.desc }}
            {{ $links := cond (isset $it "links") (sort $it.links "sort_order" "asc") (slice) }}
            {{ $prim  := where $links "primary" true }}
            {{ $purl  := "" }}
            {{ if gt (len $prim) 0 }}
              {{ $purl = (index $prim 0).href }}
            {{ else if gt (len $links) 0 }}
              {{ $purl = (index $links 0).href }}
            {{ end }}

            {{ $isFeatured := eq $i 0 }}
            <article class="card slide {{ if $isVideo }}is-video{{ else }}is-content{{ end }}{{ if $isFeatured }} card--featured{{ end }}" role="listitem" data-kind="{{ if $isVideo }}video{{ else }}content{{ end }}" data-title="{{ $tit }}" data-desc="{{ $desc }}" data-overline="{{ $over }}">
              {{ if and $isVideo (ne $purl "") }}
                <div class="card__media">
                  <img
                    class="card__img"
                    src="{{ $thumbURL }}"
                    sizes="(max-width: 479px) 320px, (max-width: 1023px) 340px, 360px"
                    width="1280" height="720"
                    decoding="async"
                    loading="{{ if eq $i 0 }}eager{{ else }}lazy{{ end }}"
                    fetchpriority="{{ if eq $i 0 }}high{{ else }}low{{ end }}"
                    alt="{{ if $tit }}{{ $tit }}{{ else }}Immagine contenuto{{ end }}"
                  />
                  <span class="card__media-overlay"></span>
                  <a href="{{ $purl }}" target="_blank" rel="noopener noreferrer" class="card__play" aria-label="Guarda video: {{ $tit }}">
                    <svg class="card__play-icon" viewBox="0 0 100 100" aria-hidden="true" focusable="false">
                      <circle class="card__play-circle" cx="50" cy="50" r="34" />
                      <polygon class="card__play-tri" points="35,32 65,50 35,68" />
                    </svg>
                  </a>
                </div>
                <div class="card__body">
                  {{ with $over }}<p class="card__overline">{{ . }}</p>{{ end }}
                  <h3 class="card__title">{{ $tit }}</h3>
                  {{ with $desc }}<p class="card__desc">{{ . }}</p>{{ end }}
                </div>
              {{ else }}
                <div class="card__media">
                  <img
                    class="card__img"
                    src="{{ $thumbURL }}"
                    sizes="(max-width: 479px) 320px, (max-width: 1023px) 340px, 360px"
                    width="1280" height="720"
                    decoding="async"
                    loading="{{ if eq $i 0 }}eager{{ else }}lazy{{ end }}"
                    fetchpriority="{{ if eq $i 0 }}high{{ else }}low{{ end }}"
                    alt="{{ if $tit }}{{ $tit }}{{ else }}Immagine contenuto{{ end }}"
                  />
                  <span class="card__media-overlay"></span>
                </div>
                <div class="card__body">
                  {{ with $over }}<p class="card__overline">{{ . }}</p>{{ end }}
                  <h3 class="card__title">{{ $tit }}</h3>
                  {{ with $desc }}<p class="card__desc">{{ . }}</p>{{ end }}
                </div>
                <div class="card__actions">
                  {{ if ne $purl "" }}
                    <a class="btn btn--primary"
                       href="{{ $purl }}"
                       target="_blank" rel="noopener noreferrer">Apri</a>
                  {{ else }}
                    <a class="btn btn--primary" href="{{ "/archive/" | absURL }}">Altro</a>
                  {{ end }}
                </div>
              {{ end }}
            </article>
          {{ end }}
        {{ else }}
          <!-- Nessun item: CTA coerente con legacy -->
          <div class="card card--empty">
            <div class="card__body">
              <h3 class="card__title">Nessun contenuto</h3>
              <p class="card__desc">Contenuti in arrivo.</p>
            </div>
            <div class="card__actions">
              <a class="btn btn--primary" href="{{ "/archive/" | absURL }}">Altro</a>
            </div>
          </div>
        {{ end }}
      </div>
      </div>
      <div class="cards__controls" aria-label="Controlli carousel">
        <button class="cards__nav cards__nav--prev" type="button" aria-controls="cards-carousel" aria-label="Elemento precedente">‹</button>
        <button class="cards__nav cards__nav--next" type="button" aria-controls="cards-carousel" aria-label="Elemento successivo">›</button>
      </div>
      <div class="cards__details" aria-live="polite">
        <p class="cards__details-over"></p>
        <h3 class="cards__details-title"></h3>
        <p class="cards__details-desc"></p>
      </div>
    </div>
  </section>
  <!-- <<< END CARDS -->


  <!-- >>> START LINKS -->
  <section class="links" aria-labelledby="links-title">
  <div class="links__inner">
    <h2 id="links-title" class="links__title">Amici, Partners &amp; Links</h2>

    <div class="links__grid">
      <ul class="links__list" role="list">
        <li class="link-card link-card--full">
          <a class="link-card__link" href="https://www.ebay.it/" target="_blank" rel="noopener noreferrer">
            <img class="link-card__logo" src="{{ "images/links/ebay_logo.png" | absURL }}?v={{ with site.Params.appVer }}{{ . }}{{ end }}" alt="eBay" width="40" height="40" loading="lazy" decoding="async">
            <div class="link-card__meta"></div>
          </a>
        </li>

        <li class="link-card">
          <a class="link-card__link" href="https://linktr.ee/boosemtg" target="_blank" rel="noopener noreferrer">
            <img class="link-card__logo" src="{{ "images/links/boose_logo.webp" | absURL }}?v={{ with site.Params.appVer }}{{ . }}{{ end }}" alt="B&#216;&#216;SE MTG" width="40" height="40" loading="lazy" decoding="async">
            <div class="link-card__meta">
              <span class="link-card__name">B&#216;&#216;SE MTG</span>
              <span class="link-card__copy">Friends &amp; Games</span>
            </div>
          </a>
        </li>

        <li class="link-card">
          <a class="link-card__link" href="https://www.facebook.com/Multiverseofgames/" target="_blank" rel="noopener noreferrer">
            <img class="link-card__logo" src="{{ "images/links/multiverse_logo.png" | absURL }}?v={{ with site.Params.appVer }}{{ . }}{{ end }}" alt="Multiverse of Games" width="40" height="40" loading="lazy" decoding="async">
            <div class="link-card__meta">
              <span class="link-card__name">Multiverse of Games</span>
              <span class="link-card__copy">Friendly LGS</span>
            </div>
          </a>
        </li>

        <li class="link-card">
          <a class="link-card__link" href="https://www.domenicocava.com/" target="_blank" rel="noopener noreferrer">
            <img class="link-card__logo" src="{{ "images/links/cava_logo.png" | absURL }}?v={{ with site.Params.appVer }}{{ . }}{{ end }}" alt="Domenico Cava" width="40" height="40" loading="lazy" decoding="async">
            <div class="link-card__meta">
              <span class="link-card__name">Domenico Cava</span>
              <span class="link-card__copy">Illustrator for MtG</span>
            </div>
          </a>
        </li>

        <li class="link-card">
          <a class="link-card__link" href="https://archidekt.com/search/decks?ownerUsername=Mtg.derrick" target="_blank" rel="noopener noreferrer">
            <img class="link-card__logo" src="{{ "images/links/derrick_logo.png" | absURL }}?v={{ with site.Params.appVer }}{{ . }}{{ end }}" alt="mtg.Derrick" width="40" height="40" loading="lazy" decoding="async">
            <div class="link-card__meta">
              <span class="link-card__name">MtG Derrick</span>
              <span class="link-card__copy">Liste Commander</span>
            </div>
          </a>
        </li>

      </ul>
    </div>
  </div>
  </section>
  <!-- <<< END LINKS -->

  <!-- >>> START CONTACTS -->
  <section id="contacts" class="contacts" aria-labelledby="contacts-title">
  <div class="contacts__inner">
    <div class="contacts__grid">
      <div class="contacts__copy">
        <h2 id="contacts-title" class="contacts__title">Chi siamo</h2>
        <p class="contacts__intro">
          Siamo Vincenzo e Francesco, amici appassionati di Magic: The Gathering, Dungeons & Dragons, giochi da tavolo e videogiochi.
        </p>
        <p class="contacts__sub">Restiamo in contatto</p>
      </div>

      <div class="contacts__actions">
        <ul class="contacts__list" role="list">
          <li>
            <a class="contact" href="https://www.tiktok.com/@eventhorizonmtg" target="_blank" rel="noopener noreferrer" aria-label="TikTok" title="TikTok">
              <span class="contact__icon icon-tiktok" aria-hidden="true"></span>
            </a>
          </li>
          <li>
            <a class="contact" href="https://www.instagram.com/eventhorizon.mtg" target="_blank" rel="noopener noreferrer" aria-label="Instagram" title="Instagram">
              <span class="contact__icon icon-instagram" aria-hidden="true"></span>
            </a>
          </li>
          <li>
            <a class="contact" href="https://www.youtube.com/@EventHorizonMtG" target="_blank" rel="noopener noreferrer" aria-label="YouTube" title="YouTube">
              <span class="contact__icon icon-youtube" aria-hidden="true"></span>
            </a>
          </li>
          <li>
            <a class="contact" href="https://t.me/eventhorizonmtg" target="_blank" rel="noopener noreferrer" aria-label="Telegram" title="Telegram">
              <span class="contact__icon icon-telegram" aria-hidden="true"></span>
            </a>
          </li>
          <li>
            <a class="contact" href="https://discord.com/invite/tQrbzhUa4k" target="_blank" rel="noopener noreferrer" aria-label="Discord" title="Discord">
              <span class="contact__icon icon-discord" aria-hidden="true"></span>
            </a>
          </li>
        </ul>
        <a class="contact contact--mail" href="mailto:eventhorizon@growupnetwork.it" aria-label="Email" title="Email">
          <span class="contact__icon icon-mail" aria-hidden="true"></span>
        </a>
      </div>
    </div>
  </div>
  </section>
  <!-- <<< END CONTACTS -->


</main>
{{ end }}




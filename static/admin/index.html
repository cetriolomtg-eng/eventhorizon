<!doctype html>
<html lang="it">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Admin · Decap CMS</title>
    <!-- Versione fissata per stabilità -->
    <script src="https://unpkg.com/decap-cms@3.8.3/dist/decap-cms.js"></script>
    <style>
      html,body { height:100%; background:#0e0f1a; color:#eaeef8; }
      .nc-appHeader-root { background: rgba(47,39,96,.9); backdrop-filter: blur(6px); }
      a, .nc-collectionCard-link { color:#00ADB1; }
    </style>
  </head>
  <body>
    <script>
      // === CONFIG ===
      const SITE_URL = "https://eventhorizon-mtg.github.io";
      const WORKER_BASE_URL = "https://eventhorizon-oauth.cetriolo-mtg.workers.dev";

      CMS.init({
        config: {
          backend: {
            name: "github",
            repo: "eventhorizon-mtg/eventhorizon-mtg.github.io",
            branch: "test",
            base_url: WORKER_BASE_URL,
            auth_endpoint: "auth",
            // ⬇️ INSERISCI QUI IL TUO CLIENT ID (NON il secret)
            app_id: "Ov23liuGRKkJ7ujGpqXE"
          },
          site_url: SITE_URL,
          media_folder: "static/uploads",
          public_folder: "/uploads",
          locale: "it",
          load_config_file: false, // teniamo tutto inline per il primo setup
          collections: [
            {
              name: "pagine",
              label: "Pagine",
              folder: "content/pages",
              create: true,
              slug: "{{slug}}",
              fields: [
                { label: "Titolo", name: "title", widget: "string" },
                { label: "Data", name: "date", widget: "datetime" },
                { label: "Contenuto", name: "body", widget: "markdown" }
              ]
            }
          ]
        }
      });

      console.log("Decap CMS avviato (GitHub backend + Cloudflare Worker OAuth).");
    </script>
  </body>
</html>

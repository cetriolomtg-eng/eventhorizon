<!doctype html>
<html lang="it">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>EventHorizon Admin</title>

    <!-- Favicon minimale per evitare 404 (opzionale) -->
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Ctext y='14' font-size='14'%3EEH%3C/text%3E%3C/svg%3E">

    <!-- Bridge "one-shot": legge l'hash e lo riposta UNA volta a Decap -->
    <script>
      (function () {
        var raw = location.hash ? decodeURIComponent(location.hash.slice(1)) : "";
        var isAuth = typeof raw === "string" && raw.startsWith("authorization:github:");
        if (isAuth) {
          // aspetta che Decap monti, poi riposta e pulisce l'hash
          window.addEventListener("load", function () {
            try { window.postMessage(raw, window.location.origin); } catch (_) {}
            try { history.replaceState(null, "", location.pathname); } catch (_) {}
          });
        }
      })();
    </script>

    <!-- Carica una sola volta Decap; niente CMS.init() -->
    <script src="https://unpkg.com/decap-cms@3.8.3/dist/decap-cms.js"></script>
  </head>
  <body></body>
</html>
